<p-dialog
  [(visible)]="display"
  [header]="header"
  [closable]="true"
  [modal]="true"
  [style]="{ width: '800px' }"
  [baseZIndex]="10000"
  (onHide)="closeDialog()"
>
  <!-- Thông tin chung -->
  <p-panel header="Thông tin chung" class="mb-3">
    <form class="p-fluid">
      <!-- Tên sản phẩm -->
      <div class="field">
        <label for="productName">Tên sản phẩm</label>
        <input
          id="productName"
          type="text"
          pInputText
          [(ngModel)]="product.name"
          name="productName"
          placeholder="Nhập tên sản phẩm"
        />
      </div>

      <!-- Giá sản phẩm -->
      <div class="field">
        <label for="productPrice">Giá</label>
        <input
          id="productPrice"
          type="number"
          pInputText
          [(ngModel)]="product.price"
          name="productPrice"
          placeholder="Nhập giá sản phẩm"
        />
      </div>

      <!-- Loại sản phẩm -->
      <div class="field">
        <label for="productCategory">Loại sản phẩm</label>
        <p-dropdown
          [options]="categories"
          [(ngModel)]="product.category"
          name="productCategory"
          placeholder="Chọn loại sản phẩm"
        ></p-dropdown>
      </div>
    </form>
  </p-panel>

  <!-- Chi tiết sản phẩm -->
  <p-panel header="Chi tiết sản phẩm">
    <form class="p-fluid">
      <div class="p-grid">
        <!-- Màu sắc -->
        <div class="field p-col-3">
          <label for="productColor">Màu sắc</label>
          <p-dropdown
            [options]="colorOptions"
            [(ngModel)]="detail.color"
            name="productColor"
            placeholder="Chọn màu sắc"
          ></p-dropdown>
        </div>

        <!-- Kích thước -->
        <div class="field p-col-3">
          <label for="productSize">Kích thước</label>
          <p-dropdown
            [options]="sizeOptions"
            [(ngModel)]="detail.size"
            name="productSize"
            placeholder="Chọn kích thước"
          ></p-dropdown>
        </div>

        <!-- Chọn ảnh -->
        <div class="field p-col-3">
          <label for="productImage">Ảnh</label>
          <input
            id="productImage"
            type="file"
            (change)="onFileSelected($event)"
            placeholder="Chọn file ảnh"
          />
          <button
            pButton
            type="button"
            label="Tải ảnh lên"
            class="p-button-primary"
            (click)="uploadImage()"
            [disabled]="!selectedFile"
          ></button>
        </div>

        <!-- Tồn kho -->
        <div class="field p-col-2">
          <label for="productStock">Tồn kho</label>
          <input
            id="productStock"
            type="number"
            pInputText
            [(ngModel)]="detail.stock"
            name="productStock"
            placeholder="Tồn kho"
          />
        </div>

        <!-- Nút thêm chi tiết -->
        <div class="field p-col-1">
          <label>&nbsp;</label>
          <button
            pButton
            type="button"
            label="Thêm"
            class="p-button-success"
            (click)="addDetail()"
          ></button>
        </div>
      </div>
    </form>

    <!-- Bảng danh sách chi tiết sản phẩm -->
    <p-table
      [value]="productDetails"
      [paginator]="true"
      [rows]="5"
      [responsiveLayout]="'scroll'"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>Màu sắc</th>
          <th>Kích thước</th>
          <th>Ảnh</th>
          <th>Tồn kho</th>
          <th>Hành động</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-detail>
        <tr>
          <td>{{ detail.color }}</td>
          <td>{{ detail.size }}</td>
          <td>
            <img [src]="detail.image" alt="Ảnh" style="width: 50px; height: 50px;" />
          </td>
          <td>{{ detail.stock }}</td>
          <td>
            <button
              pButton
              type="button"
              icon="pi pi-trash"
              class="p-button-text p-button-danger"
              (click)="deleteDetail(detail)"
            ></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-panel>

  <!-- Nút hành động -->
  <div class="p-d-flex p-jc-end mt-3">
    <button
      pButton
      type="button"
      label="Hủy"
      icon="pi pi-times"
      class="p-button-text"
      (click)="closeDialog()"
    ></button>
    <button
      pButton
      type="button"
      label="Lưu sản phẩm"
      icon="pi pi-check"
      class="p-button-primary"
      (click)="saveProduct()"
    ></button>
  </div>
</p-dialog>
